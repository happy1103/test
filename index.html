<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>人物分類顯示</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    button { margin: 5px; padding: 10px; }
    .highlight { font-weight: bold; color: red; }
    .category { margin-top: 20px; }
    .suggestion { color: green; font-style: italic; }
    .score { margin-top: 20px; font-size: 18px; color: blue; }
    .group-section { margin-bottom: 20px; }
    #toggle-all { margin: 10px 0; padding: 5px 10px; }
    .captain-label { font-size: 12px; color: white; background: darkred; padding: 2px 4px; margin-left: 5px; border-radius: 3px; }
  </style>
</head>
<body>
  <h1>選擇人物</h1>
  <button id="toggle-all">隱藏所有角色</button>
  <div id="person-buttons"></div>
  <div id="results"></div>
  <div class="score" id="score"></div>

  <script>
    const data = { "天祥院英智": { 團體: ["fine"], 社團: ["運動生存者", "茶話會 茗味"], 宿舍: ["301"], 洗牌團體: ["Ring A Bell"], 隊長: "" }, "日日樹涉": { 團體: ["fine"], 社團: ["生物俱樂部 陸地", "浪漫劇團A"], 宿舍: ["102"], 洗牌團體: ["Puffy Bunny"], 隊長: "" }, "姬宮桃李": { 團體: ["fine"], 社團: ["漫畫會", "Pretty 5"], 宿舍: ["107"], 洗牌團體: ["Branco"], 隊長: "" }, "伏見弓弦": { 團體: ["fine"], 社團: ["ES講座 敬人塾", "丹希廚房"], 宿舍: ["107"], 洗牌團體: ["Flambe"], 隊長: "" }, "冰鷹北斗": { 團體: ["Trickstar"], 社團: ["浪漫劇團B", "創作怪物"], 宿舍: ["202"], 洗牌團體: ["月都奇觀"], 隊長: "" }, "明星昴流": { 團體: ["Trickstar"], 社團: ["運動生存者", "生物俱樂部 陸地"], 宿舍: ["102"], 洗牌團體: ["Flambe"], 隊長: "" }, "衣更真緒": { 團體: ["Trickstar"], 社團: ["漫畫會", "BB樂隊"], 宿舍: ["303"], 洗牌團體: ["Ring A Bell"], 隊長: "" }, "遊木真": { 團體: ["Trickstar"], 社團: ["神秘部", "創作怪物"], 宿舍: ["204"], 洗牌團體: ["XXVeil"], 隊長: "" }, "守澤千秋": { 團體: ["流星隊"], 社團: ["運動生存者", "武道家 心"], 宿舍: ["204"], 洗牌團體: ["√A to Z"], 隊長: "" }, "深海奏汰": { 團體: ["流星隊"], 社團: ["生物俱樂部 海洋", "神秘部"], 宿舍: ["304"], 洗牌團體: ["月都奇觀"], 隊長: "" }, "南雲鐵虎": { 團體: ["流星隊"], 社團: ["ES講座 茨塾", "武道家 心"], 宿舍: ["103"], 洗牌團體: ["舞鬪會"], 隊長: "" }, "高峯翠": { 團體: ["流星隊"], 社團: ["漫畫會", "園藝者"], 宿舍: ["203"], 洗牌團體: ["Ring A Bell"], 隊長: "" }, "仙石忍": { 團體: ["流星隊"], 社團: ["生物俱樂部 海洋", "玩樂部"], 宿舍: ["305"], 洗牌團體: ["Puffy Bunny"], 隊長: "" }, "天城一彩": { 團體: ["Alkaloid"], 社團: ["ES講座 敬人塾", "武道家 心"], 宿舍: ["205"], 洗牌團體: ["Puffy Bunny"], 隊長: "" }, "白鳥藍良": { 團體: ["Alkaloid"], 社團: ["ES講座 敬人塾", "Pretty 5"], 宿舍: ["301"], 洗牌團體: ["Branco"], 隊長: "" }, "風早巽": { 團體: ["Alkaloid"], 社團: ["茶話會 茗味", "園藝者"], 宿舍: ["105"], 洗牌團體: ["月都奇觀"], 隊長: "" }, "禮瀨真宵": { 團體: ["Alkaloid"], 社團: ["留宿戶外隊", "甜品會"], 宿舍: ["104"], 洗牌團體: ["La Mort"], 隊長: "" }, "亂凪砂": { 團體: ["Eden"], 社團: ["浪漫劇團A", "書會 群書"], 宿舍: ["201"], 洗牌團體: ["La Mort"], 隊長: "" }, "巴日和": { 團體: ["Eden"], 社團: ["茶話會 茗味", "Pretty 5"], 宿舍: ["304"], 洗牌團體: ["月都奇觀"], 隊長: "" }, "漣純": { 團體: ["Eden"], 社團: ["漫畫會", "玩樂部"], 宿舍: ["106"], 洗牌團體: ["舞鬪會"], 隊長: "" }, "七種茨": { 團體: ["Eden"], 社團: ["ES講座 茨塾", "丹希廚房"], 宿舍: ["203"], 洗牌團體: ["Flambe"], 隊長: "" }, "天城燐音": { 團體: ["Crazy:B"], 社團: ["玩樂部", "創作怪物"], 宿舍: ["304"], 洗牌團體: ["Flambe"], 隊長: "" }, "椎名丹希": { 團體: ["Crazy:B"], 社團: ["留宿戶外隊", "丹希廚房"], 宿舍: ["205"], 洗牌團體: ["√A to Z"], 隊長: "" }, "Himeru": { 團體: ["Crazy:B"], 社團: ["ES講座 茨塾", "甜品會"], 宿舍: ["103"], 洗牌團體: ["XXVeil"], 隊長: "" }, "櫻河琥珀": { 團體: ["Crazy:B"], 社團: ["茶話會 Kaori", "甜品會"], 宿舍: ["106"], 洗牌團體: ["La Mort"], 隊長: "" }, "齋宮宗": { 團體: ["Valkyrie"], 社團: ["浪漫劇團A", "創作怪物"], 宿舍: ["303"], 洗牌團體: ["Blend+"], 隊長: "" }, "影片美伽": { 團體: ["Valkyrie"], 社團: ["ES講座 敬人塾", "Pretty 5"], 宿舍: ["101"], 洗牌團體: ["Puffy Bunny"], 隊長: "" }, "葵日向": { 團體: ["2wink"], 社團: ["園藝者", "BB樂隊"], 宿舍: ["205"], 洗牌團體: ["Puffy Bunny"], 隊長: "" }, "葵裕太": { 團體: ["2wink"], 社團: ["玩樂部", "BB樂隊"], 宿舍: ["201"], 洗牌團體: ["Blend+"], 隊長: "" }, "朔間零": { 團體: ["Undead"], 社團: ["神秘部", "BB樂隊"], 宿舍: ["301"], 洗牌團體: ["La Mort"], 隊長: "" }, "羽風薰": { 團體: ["Undead"], 社團: ["生物俱樂部 海洋", "書會 群書"], 宿舍: ["201"], 洗牌團體: ["√A to Z"], 隊長: "" }, "大神晃牙": { 團體: ["Undead"], 社團: ["生物俱樂部 陸地", "BB樂隊"], 宿舍: ["105"], 洗牌團體: ["Blend+"], 隊長: "" }, "乙狩阿多尼斯": { 團體: ["Undead"], 社團: ["運動生存者", "茶話會 Kaori"], 宿舍: ["204"], 洗牌團體: ["舞鬪會"], 隊長: "" }, "蓮巳敬人": { 團體: ["紅月"], 社團: ["ES講座 敬人塾", "浪漫劇團A", "漫畫會"], 宿舍: ["202"], 洗牌團體: ["Ring A Bell"], 隊長: "" }, "鬼龍紅郎": { 團體: ["紅月"], 社團: ["留宿戶外隊", "武道家 心"], 宿舍: ["303"], 洗牌團體: ["舞鬪會"], 隊長: "" }, "神崎颯馬": { 團體: ["紅月"], 社團: ["茶話會 Kaori", "生物俱樂部 海洋", "丹希廚房"], 宿舍: ["305"], 洗牌團體: ["XXVeil"], 隊長: "" }, "滝維吹": { 團體: ["紅月"], 社團: [], 宿舍: ["104"], 洗牌團體: [], 隊長: "" }, "真白友也": { 團體: ["Rabits"], 社團: ["生物俱樂部 陸地", "浪漫劇團B"], 宿舍: ["104"], 洗牌團體: ["Flambe"], 隊長: "" }, "仁兔成鳴": { 團體: ["Rabits"], 社團: ["生物俱樂部 陸地", "神秘部"], 宿舍: ["302"], 洗牌團體: ["XXVeil"], 隊長: "" }, "天滿光": { 團體: ["Rabits"], 社團: ["留宿戶外隊", "運動生存者"], 宿舍: ["203"], 洗牌團體: ["√A to Z"], 隊長: "" }, "紫之創": { 團體: ["Rabits"], 社團: ["茶話會 茗味", "書會 群書", "園藝者"], 宿舍: ["202"], 洗牌團體: ["Branco"], 隊長: "" }, "朱櫻司": { 團體: ["Knights"], 社團: ["茶話會 Kaori", "書會 群書", "甜品會"], 宿舍: ["305"], 洗牌團體: ["Blend+"], 隊長: "" }, "月永雷歐": { 團體: ["Knights"], 社團: ["留宿戶外隊", "浪漫劇團A"], 宿舍: ["302"], 洗牌團體: ["Ring A Bell"], 隊長: "" }, "瀨名泉": { 團體: ["Knights"], 社團: ["生物俱樂部 海洋", "丹希廚房"], 宿舍: ["303"], 洗牌團體: ["XXVeil"], 隊長: "" }, "朔間凜月": { 團體: ["Knights"], 社團: ["茶話會 茗味", "創作怪物"], 宿舍: ["101"], 洗牌團體: ["La Mort"], 隊長: "" }, "鳴上嵐": { 團體: ["Knights"], 社團: ["浪漫劇團B", "Pretty 5"], 宿舍: ["103"], 洗牌團體: ["月都奇觀"], 隊長: "" }, "逆先夏目": { 團體: ["Switch"], 社團: ["ES講座 茨塾", "浪漫劇團B", "園藝者"], 宿舍: ["302"], 洗牌團體: ["√A to Z"], 隊長: "" }, "青葉紡": { 團體: ["Switch"], 社團: ["書會 群書", "神秘部"], 宿舍: ["203"], 洗牌團體: ["Blend+"], 隊長: "" }, "春川宙": { 團體: ["Switch"], 社團: ["ES講座 茨塾", "玩樂部"], 宿舍: ["102"], 洗牌團體: ["Branco"], 隊長: "" }, "三毛縞斑": { 團體: ["MaM"], 社團: ["茶話會 Kaori", "武道家 心"], 宿舍: ["102"], 洗牌團體: ["舞鬪會"], 隊長: "" }, "冴霧笑主": { 團體: ["SFP"], 社團: [], 宿舍: ["106"], 洗牌團體: [], 隊長: "" }, "花群冬芽": { 團體: ["SFP"], 社團: [], 宿舍: ["101"], 洗牌團體: [], 隊長: "" }, "名都神無": { 團體: ["SFP"], 社團: [], 宿舍: ["105"], 洗牌團體: [], 隊長: "" }, "寶丈萊香": { 團體: ["SFP"], 社團: [], 宿舍: ["107"], 洗牌團體: [], 隊長: "" } }; 

    const scoreMap = {1: 1, 2: 2, 3: 4, 4: 6, 5: 9};
    const selected = new Set();
    const personButtons = document.getElementById('person-buttons');
    const results = document.getElementById('results');
    const scoreDiv = document.getElementById('score');

    const groupMap = {};
    for (let name in data) {
      const group = data[name].團體[0];
      if (!groupMap[group]) groupMap[group] = [];
      groupMap[group].push(name);
    }

    const buttonElements = {};

    for (let group in groupMap) {
      const section = document.createElement('div');
      section.className = 'group-section';
      section.dataset.group = group;
      const title = document.createElement('h3');
      title.textContent = `團體 ${group}`;
      section.appendChild(title);

      groupMap[group].forEach(name => {
        const btn = document.createElement('button');
        btn.className = 'person';
        btn.dataset.name = name;

        const label = data[name].隊長 === '是' ? ' <span class="captain-label">隊長</span>' : '';
        btn.innerHTML = `${name}${label}`;

        btn.onclick = () => {
          if (selected.has(name)) {
            selected.delete(name);
            btn.style.background = '';
          } else {
            selected.add(name);
            btn.style.background = '#d3f';
          }
          showResults();
        };
        buttonElements[name] = btn;
        section.appendChild(btn);
      });

      personButtons.appendChild(section);
    }

    let hidden = false;
    document.getElementById('toggle-all').onclick = () => {
      const allSections = document.querySelectorAll('.group-section');
      hidden = !hidden;
      allSections.forEach(sec => sec.style.display = hidden ? 'none' : '');
      document.getElementById('toggle-all').textContent = hidden ? '顯示所有角色' : '隱藏所有角色';
    };

    function showResults() {
      const categoryMap = { 團體: {}, 社團: {}, 宿舍: {}, 洗牌團體: {} };
      Object.entries(data).forEach(([name, attrs]) => {
        for (let cat of ['團體', '社團', '宿舍', '洗牌團體']) {
          attrs[cat].forEach(value => {
            if (!categoryMap[cat][value]) categoryMap[cat][value] = [];
            categoryMap[cat][value].push(name);
          });
        }
      });

      let output = '';
      let totalScore = 0;

      for (let cat of ['團體', '社團', '宿舍', '洗牌團體']) {
        output += `<div class="category"><strong>${cat}：</strong><ul>`;
        const relevant = {};
        [...selected].forEach(name => {
          data[name][cat].forEach(val => relevant[val] = true);
        });
        for (let key in categoryMap[cat]) {
          const members = categoryMap[cat][key];
          const inGroup = members.filter(n => selected.has(n));
          if (!relevant[key]) continue;

          const highlighted = members.map(n => selected.has(n) ? `<span class="highlight">「${n}」</span>` : n);
          output += `<li>${key}（${highlighted.join('，')}）`;

          if (inGroup.length === members.length - 1) {
            const missing = members.find(n => !selected.has(n));
            output += ` <span class="suggestion">→ 建議蒐集：${missing}</span>`;
          }

          output += '</li>';

          if (inGroup.length === members.length) {
            const size = members.length;
            totalScore += scoreMap[size] || 0;
          }
        }
        output += '</ul></div>';
      }

      // 隊長加分
      selected.forEach(name => {
        if (data[name].隊長 === '是') {
          totalScore += 1;
        }
      });

      results.innerHTML = output;
      scoreDiv.innerText = `當前分數：${totalScore} 分（含隊長加分）`;
    }
  </script>
</body>
</html>
